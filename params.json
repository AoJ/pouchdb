{"name":"Pouchdb","body":"Tests are passing and this is ready for more usage/feedback. Works with Chrome 11/12 and Firefox 4.\r\n\r\n# PouchDB ( Portable CouchDB JavaScript implementation )\r\n\r\nPouchDB is a complete implementation of the CouchDB storage and views API that supports peer-to-peer replication with other CouchDB instances. The browser version is written for IndexedDatabase (part of HTML5). An additional implementation is in progress for leveldb.\r\n\r\n#### Storage and Consistency\r\n\r\nUnlike the other current couch-like browser APIs built on WebStorage (http://dev.w3.org/html5/webstorage/) PouchDB's goal is to maintain the same kinds of consistency guarantees Apache CouchDB provides across concurrent connections across the multiple-tabs a user might be using to concurrently access an PouchDB database. This is something that just isn't possible with the BrowserStorage API previous libraries like BrowserCouch and lawnchair use.\r\n\r\nPouchDB also keeps a by-sequence index across the entire database. This means that, just like Apache CouchDB, PouchDB can replicate with other CouchDB instances and provide the same conflict resolution system for eventual consistency across nodes.\r\n\r\n#### BrowserCouch\r\n\r\nAt this time PouchDB is completely independent from BrowserCouch. The main reason is just to keep the code base concise and focused as the IndexedDatabase specification is being flushed out.\r\n\r\nAfter IndexedDatabase is more solidified it's possible that BrowserCouch and PouchDB might merge to provide a simple fallback option for browsers the do not yet support IndexedDatabase.\r\n\r\n# Getting started\r\n\r\nRunning `$ make` or `$ make min` in the project will give you a `pouch.alpha.js` or `pouch.alpha.min.js` which you can simple include on the page:\r\n\r\n    <script type=\"text/javascript\" src=\"../pouch.alpha.min.js\"></script>\r\n\r\n# API\r\n\r\nMost of the Pouch API is exposed as `fun(arg, [options], [callback])` Where both the options and the callback are optional. Callbacks are in the node.js idiom of `function(err, data)` Where the first argument will be undefined unless there is an error, further arguments specify the result.\r\n\r\n## new Pouch('idb://dbname', [options], [callback])\r\n\r\nThis method gets an existing database if one exists or creates a new one if one does not exist. The protocol field denotes which backend you want to use (currently only http and indexeddb are supported)\r\n\r\n<pre>\r\nnew Pouch('idb://test', function(err, db) {\r\n  // Use db to call further functions\r\n})\r\n</pre>\r\n\r\n## db\r\n\r\nThe subject of the of pouch.open. This is primary PouchDB API.\r\n\r\n### db.post(doc, [options], [callback])\r\n\r\nCreate a new document.\r\n\r\n<pre>\r\ndb.post({ title: 'Cony Island Baby' }, function(err, response) {\r\n  // Response:\r\n  // {\r\n  //   \"ok\": true,\r\n  //   \"id\": \"0B3358C1-BA4B-4186-8795-9024203EB7DD\",\r\n  //   \"rev\": \"1-5782E71F1E4BF698FA3793D9D5A96393\"\r\n  // }\r\n})\r\n</pre>\r\n\r\n\r\n### db.put(doc, [options], [callback])\r\n\r\nCreate a new document or update an existing document.\r\n\r\n<pre>\r\ndb.put({ _id: 'mydoc', title: 'Rock and Roll Heart' }, function(err, response) {\r\n  // Response:\r\n  // {\r\n  //   \"ok\": true,\r\n  //   \"id\": \"mydoc\",\r\n  //   \"rev\": \"1-A6157A5EA545C99B00FF904EEF05FD9F\"\r\n  // }\r\n})\r\n</pre>\r\n\r\n\r\n### db.get(docid, [options], [callback])\r\n\r\nGetrieves a document, specified by `docid`.\r\n\r\n* `options.revs`: Include revision history of the document\r\n* `options.revs_info`: Include a list of revisions of the document, and their availability\r\n\r\n<pre>\r\ndb.get('mydoc', function(err, doc) {\r\n  // Document:\r\n  // {\r\n  //   \"title\": \"Rock and Roll Heart\",\r\n  //   \"_id\": \"mydoc\",\r\n  //   \"_rev\": \"1-A6157A5EA545C99B00FF904EEF05FD9F\"\r\n  // }\r\n})\r\n</pre>\r\n\r\n\r\n### db.putAttachment(id, rev, doc, type, [callback])\r\n\r\nCreate an attachment in an existing document.\r\n\r\n<pre>\r\ndb.put({ _id: 'otherdoc', title: 'Legendary Hearts' }, function(err, response) {\r\n  var doc = 'Legendary hearts, tear us all apart\\nMake our emotions bleed, crying out in need';\r\n  db.putAttachment('otherdoc/text', response.rev, doc, 'text/plain', function(err, res) {\r\n    // Response:\r\n    // {\r\n    //   \"ok\": true,\r\n    //   \"id\": \"otherdoc\",\r\n    //   \"rev\": \"2-068E73F5B44FEC987B51354DFC772891\"\r\n    // }\r\n  })\r\n})\r\n</pre>\r\n\r\n\r\n### db.bulkDocs(docs, [options], [callback])\r\n\r\nModify multiple documents.\r\n\r\n<pre>\r\ndb.bulkDocs({ docs: [{ title: 'Lisa Says' }] }, function(err, response) {\r\n  // Response array:\r\n  // [\r\n  //   {\r\n  //     \"ok\": true,\r\n  //     \"id\": \"828124B9-3973-4AF3-9DFD-A94CE4544005\",\r\n  //     \"rev\": \"1-A8BC08745E62E58830CA066D99E5F457\"\r\n  //   }\r\n  // ]\r\n})\r\n</pre>\r\n\r\n\r\n### db.allDocs([options], [callback])\r\n\r\nFetch multiple documents.\r\n\r\n* `options.include_docs`: Include the associated document with each change\r\n* `options.conflicts`: Include conflicts\r\n* `options.startkey` & `options.endkey`: Get documents with keys in a certain range\r\n* `options.descending`: Reverse the order of the output table\r\n\r\n<pre>\r\ndb.allDocs(function(err, response) {\r\n  // Document rows:\r\n  // {\r\n  //   \"total_rows\": 4,\r\n  //   \"rows\": [\r\n  //     {\r\n  //       \"id\": \"0B3358C1-BA4B-4186-8795-9024203EB7DD\",\r\n  //       \"key\": \"0B3358C1-BA4B-4186-8795-9024203EB7DD\",\r\n  //       \"value\": {\r\n  //         \"rev\": \"1-5782E71F1E4BF698FA3793D9D5A96393\"\r\n  //       }\r\n  //     },\r\n  //     {\r\n  //       \"id\": \"828124B9-3973-4AF3-9DFD-A94CE4544005\",\r\n  //       \"key\": \"828124B9-3973-4AF3-9DFD-A94CE4544005\",\r\n  //       \"value\": {\r\n  //         \"rev\": \"1-A8BC08745E62E58830CA066D99E5F457\"\r\n  //       }\r\n  //     },\r\n  //     {\r\n  //       \"id\": \"mydoc\",\r\n  //       \"key\": \"mydoc\",\r\n  //       \"value\": {\r\n  //         \"rev\": \"1-A6157A5EA545C99B00FF904EEF05FD9F\"\r\n  //       }\r\n  //     },\r\n  //     {\r\n  //       \"id\": \"otherdoc\",\r\n  //       \"key\": \"otherdoc\",\r\n  //       \"value\": {\r\n  //         \"rev\": \"1-3753476B70A49EA4D8C9039E7B04254C\"\r\n  //       }\r\n  //     }\r\n  //   ]\r\n  // }\r\n})\r\n</pre>\r\n\r\n\r\n### db.query(fun, [options], [callback])\r\n\r\nRetrieve a view.\r\n\r\n* `fun`: Name of a view function or function\r\n* `options.reduce`: To reduce or not. The default is to reduce if there is a reduce function\r\n\r\n<pre>\r\nfunction map(doc) {\r\n  if(doc.title) {\r\n    emit(doc.title, null);\r\n  }\r\n}\r\ndb.query({ map: map, function(err, response) {\r\n  // View rows:\r\n  // {\r\n  //   \"rows\": [\r\n  //     {\r\n  //       \"id\": \"0B3358C1-BA4B-4186-8795-9024203EB7DD\",\r\n  //       \"key\": \"Cony Island Baby\",\r\n  //       \"value\": null\r\n  //     },\r\n  //     {\r\n  //       \"id\": \"otherdoc\",\r\n  //       \"key\": \"Legendary Hearts\",\r\n  //       \"value\": null\r\n  //     },\r\n  //     {\r\n  //       \"id\": \"828124B9-3973-4AF3-9DFD-A94CE4544005\",\r\n  //       \"key\": \"Lisa Says\",\r\n  //       \"value\": null\r\n  //     },\r\n  //     {\r\n  //       \"id\": \"mydoc\",\r\n  //       \"key\": \"Rock and Roll Heart\",\r\n  //       \"value\": null\r\n  //     }\r\n  //   ]\r\n  // }\r\n})\r\n</pre>\r\n\r\n\r\n### db.remove(doc, [options], [callback])\r\n\r\nDelete a document.\r\n\r\n<pre>\r\ndb.get('mydoc', function(err, doc) {\r\n  db.remove(doc, function(err, response) {\r\n    // Response:\r\n    // {\r\n    //   \"ok\": true,\r\n    //   \"id\": \"mydoc\",\r\n    //   \"rev\": \"2-9AF304BE281790604D1D8A4B0F4C9ADB\"\r\n    // }\r\n  })\r\n})\r\n</pre>\r\n\r\n\r\n### db.info(callback)\r\n\r\nGet information about a database.\r\n\r\n<pre>\r\ndb.info(function(err, info) {\r\n  // Database information:\r\n  // {\r\n  //   \"db_name\": \"test\",\r\n  //   \"doc_count\": 4,\r\n  //   \"update_seq\": 0\r\n  // }\r\n})\r\n</pre>\r\n\r\n\r\n### db.changes(options)\r\n\r\nA list of changes made to documents in the database, in the order they were made.\r\n\r\n* `options.include_docs`: Include the associated document with each change\r\n* `options.continuous`: Use _longpoll_ feed\r\n* `options.conflicts`: Include conflicts\r\n* `options.descending`: Reverse the order of the output table\r\n* `options.filter`: Reference a filter function from a design document to selectively get updates\r\n* `options.since`: Start the results from the change immediately after the given sequence number\r\n\r\n<pre>\r\ndb.changes(function(err, response) {\r\n  // Changes list:\r\n  // {\r\n  //   \"results\": [\r\n  //     {\r\n  //       \"id\": \"0B3358C1-BA4B-4186-8795-9024203EB7DD\",\r\n  //       \"seq\": 1,\r\n  //       \"changes\": [\r\n  //         {\r\n  //           \"rev\": \"1-5782E71F1E4BF698FA3793D9D5A96393\"\r\n  //         }\r\n  //       ]\r\n  //     },\r\n  //     {\r\n  //       \"id\": \"mydoc\",\r\n  //       \"seq\": 2,\r\n  //       \"changes\": [\r\n  //         {\r\n  //           \"rev\": \"1-A6157A5EA545C99B00FF904EEF05FD9F\"\r\n  //         }\r\n  //       ]\r\n  //     },\r\n  //     {\r\n  //       \"id\": \"otherdoc\",\r\n  //       \"seq\": 3,\r\n  //       \"changes\": [\r\n  //         {\r\n  //           \"rev\": \"1-3753476B70A49EA4D8C9039E7B04254C\"\r\n  //         }\r\n  //       ]\r\n  //     },\r\n  //     {\r\n  //       \"id\": \"828124B9-3973-4AF3-9DFD-A94CE4544005\",\r\n  //       \"seq\": 4,\r\n  //       \"changes\": [\r\n  //         {\r\n  //           \"rev\": \"1-A8BC08745E62E58830CA066D99E5F457\"\r\n  //         }\r\n  //       ]\r\n  //     }\r\n  //   ]\r\n  // }\r\n})\r\n</pre>\r\n\r\n\r\n### db.changes.addListener(listener)\r\n\r\nRegister `listener` function for the changes feed.\r\n\r\n### db.changes.removeListener(listener)\r\n\r\n## Pouch.destroy(name, [callback])\r\n\r\nDelete database with given name\r\n\r\n<pre>\r\nPouch.destroy('idb://test', function(err, info) {\r\n  // database deleted\r\n})\r\n</pre>\r\n\r\n\r\n## Pouch.replicate(from, to, [callback])\r\n\r\nReplicate a database\r\n\r\n<pre>\r\ndb.replicate('idb://mydb', 'http://localhost:5984/mydb', function(err, changes) {\r\n  //\r\n})\r\n</pre>\r\n\r\n## Running the tests\r\n\r\nTo run the full test suite (including replication) you'll need to run a CORS proxy\r\npointing to a CouchDB.\r\n\r\n    git clone https://github.com/daleharvey/CORS-Proxy.git\r\n    cd CORS-Proxy\r\n    node server.js\r\n\r\nby default this server expects you to be running a local CouchDB instance in admin\r\nparty mode on http://127.0.0.1:5984, it will proxy requests to CouchDB and provide\r\nCORS support (see: https://github.com/daleharvey/pouchdb/issues/25)\r\n\r\nThe tests themselves also need to be served from a running server and not from the\r\nfilesystem, the simplest way to do this is:\r\n\r\n    $ cd $POUCH\r\n    $ python -m SimpleHTTPServer\r\n\r\nYou should now be able to visit http://127.0.0.1:8000/tests/test.html to run the test suite.","tagline":"PouchDB is a pocket-sized database.","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}